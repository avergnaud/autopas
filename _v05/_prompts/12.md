# Prompt 12 — CPU 100% bloqué à "Extraction des questions"

## Symptôme

- Pipeline bloqué à "Extraction des questions" avec CPU à ~99%
- Pas d'OOM cette fois, mais processus ne termine jamais

## Cause

`extract_questions` dans `parser_xlsx.py` utilisait :

```python
for row_num in range(sheet_info.first_data_row, (ws.max_row or 0) + 1):
    q_cell = ws.cell(row=row_num, column=q_col_idx)
```

**Deux problèmes combinés en mode `read_only=True` :**

1. `ws.max_row` lit la balise `<dimension>` du XML xlsx (ex. `A1:Z1048576`). Excel met souvent cette dimension à la dernière ligne jamais touchée, même si les données s'arrêtent à la ligne 130. Résultat : une boucle sur 1 048 576 itérations.

2. `ws.cell(row, col)` en mode `read_only` n'est pas un accès O(1) — openpyxl doit parcourir le flux XML séquentiellement à chaque appel, rendant la boucle O(n²).

## Correction (`parser_xlsx.py`)

- Constante `_MAX_EMPTY_ROWS = 20` ajoutée.
- `extract_questions` réécrit pour utiliser `ws.iter_rows(min_row=first_data_row)` — l'API streaming correcte pour le mode `read_only`.
- Arrêt anticipé après `_MAX_EMPTY_ROWS` lignes vides consécutives dans la colonne question.
- `write_responses` (mode écriture normal) non modifié — `ws.cell()` y est O(1) et `ws.max_row` fiable.
